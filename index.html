<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>AKAZA Servicios</title>

<style>
:root{
  --bg:#0b0b0e;
  --card:#12121a;
  --muted:#b8b8c6;
  --text:#f4f4fb;
  --border:rgba(255,255,255,.1);
  --radius:18px;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,Segoe UI,Roboto,Arial;
  background:var(--bg);
  color:var(--text);
}
.wrap{max-width:1100px;margin:auto;padding:20px}

header{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:20px;
  margin-bottom:14px;
}

.section{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:16px;
  margin-bottom:14px;
}
.section h2{margin:0 0 10px}
.section ul{margin:0;padding-left:18px;color:var(--muted)}

.tabs{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:14px}
.tab{
  padding:8px 14px;
  border-radius:999px;
  border:1px solid var(--border);
  cursor:pointer;
  font-size:13px;
  color:var(--muted);
}
.tab.active{background:#25d36633;color:#fff;border-color:#25d366}

.grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:14px;
}
@media(max-width:900px){.grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:600px){.grid{grid-template-columns:1fr}}

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:16px;
}

.logo-box{
  width:130px;
  height:130px;
  margin:auto;
  margin-bottom:10px;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#00000055;
  border-radius:22px;
}
.logo-box img{width:85%;height:85%;object-fit:contain}

.service-name{text-align:center;font-weight:800;margin-bottom:6px}
.plan{
  display:flex;
  justify-content:space-between;
  padding:10px;
  margin-bottom:6px;
  border:1px solid var(--border);
  border-radius:12px;
  cursor:pointer;
}
.price{font-weight:700}

.wa{
  margin-top:8px;
  width:100%;
  padding:12px;
  border-radius:14px;
  border:1px solid #25d366;
  background:#25d36633;
  color:#fff;
  font-weight:800;
  cursor:pointer;
}

.float-wa{
  position:fixed;
  right:16px;
  bottom:16px;
  width:56px;
  height:56px;
  border-radius:50%;
  background:#25d366;
  font-size:26px;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}
</style>
</head>

<body>
<div class="wrap">

<header>
  <h1 id="businessName">CatÃ¡logo</h1>
  <div style="color:var(--muted)">Streaming â€¢ IA â€¢ Software</div>
</header>

<!-- INFO IMPORTANTE -->
<div class="section" id="infoBox" style="display:none">
  <h2>InformaciÃ³n importante</h2>
  <ul id="infoList"></ul>
</div>

<div class="tabs" id="tabs"></div>
<div class="grid" id="grid"></div>

<!-- DISTRIBUIDORES -->
<div class="section" id="distBox" style="display:none">
  <h2>Â¿Quieres ser distribuidor?</h2>
  <ul id="distList"></ul>
</div>

</div>

<div class="float-wa" id="floatWA">âœ†</div>

<script>
const EMOJI={Streaming:"ðŸŽ¬",IA:"ðŸ¤–",Software:"ðŸ’»"};

/** convierte "Disney+ Premium" -> "disney-premium" (solo para fallback local) */
Function slugify(name){
  Return String(name||"")
    .toLowerCase()
    .trim()
    .replaceAll("+", "")
    .replaceAll("Ã¡", "a").replaceAll("Ã©", "e").replaceAll("Ã­", "i").replaceAll("Ã³", "o").replaceAll("Ãº", "u").replaceAll("Ã±", "n")
    .replace(/[^a-z0-9]+/g, "-")
    .replace(/ (^ -|-$)/g,"");
}

/** 1) intentos locales (tus PNGs) por marca */
Function localCandidates(service){
  Const s = (service||"").toLowerCase();

  // usa EXACTAMENTE estos nombres en /assets/
  If (s.includes("netflix")) Then Return ["assets/netflix.png"];
  If (s.includes("prime")) Then Return ["assets/primevideo.png","assets/prime-video.png"];
  If (s.includes("hbo")) Then Return ["assets/hbo.png","assets/hbo-max.png"];
  If (s.includes("disney")) Then Return ["assets/disney.png","assets/disneyplus.png","assets/disney-plus.png"];
  If (s.includes("crunchyroll")) Then Return ["assets/crunchyroll.png"];
  If (s.includes("paramount")) Then Return ["assets/paramount.png","assets/paramountplus.png"];
  If (s.includes("iptv")) Then Return ["assets/iptv-smarters-pro.png","assets/iptv.png"];
  If (s.includes("vix")) Then Return ["assets/vix-premium.png","assets/vix.png"];
  If (s.includes("apple tv")) Then Return ["assets/apple-tv-plus.png","assets/appletv.png"];
  If (s.includes("spotify")) Then Return ["assets/spotify.png"];
  If (s.includes("youtube")) Then Return ["assets/youtube.png"];
  If (s.includes("movistar tv")) Then Return ["assets/movistar.png"];
  If (s.includes("chatgpt")) Then Return ["assets/gpt.png"];
  If (s.includes("gemini")) Then Return ["assets/gemini.png"];
  If (s.includes("canva")) Then Return ["assets/canva.png"];
  If (s.includes("capcut")) Then Return ["assets/capcut.png"];
  If (s.includes("office")) Then Return ["assets/office.png"];
  If (s.includes("windows")) Then Return ["assets/windows.png"];
  If (s.includes("eset")) Then Return ["assets/eset.png"];
  If (s.includes("duolingo")) Then Return ["assets/duolingo.png"];
  If (s.includes("playstation")) Then Return ["assets/playstation.png"];

  // fallback genÃ©rico por si subes mÃ¡s logos
  Return [`assets/${slugify(service)}.png`];
}

/** 2) intentos CDN (si no hay local) */
Function cdnCandidates(service){
  Const s = (service||"").toLowerCase();

  If (s.includes("netflix")) Then Return ["netflix"];
  If (s.includes("hbo")) Then Return ["hbomax","hbo"];
  If (s.includes("crunchyroll")) Then Return ["crunchyroll"];
  If (s.includes("paramount")) Then Return ["paramountplus","paramount"];
  If (s.includes("apple tv")) Then Return ["appletv","appletvplus"];
  If (s.includes("spotify")) Then Return ["spotify"];
    If (s.includes("youtube")) Then Return ["assets/youtube.png"];
  If (s.includes("movistar tv")) Then Return ["assets/movistar.png"];
  If (s.includes("chatgpt")) Then Return ["assets/gpt.png"];
  If (s.includes("gemini")) Then Return ["assets/gemini.png"];

  // estos pueden fallar segÃºn el CDN, por eso van como Ãºltimo recurso
  If (s.includes("disney")) Then Return ["disneyplus","disney"];
  If (s.includes("prime")) Then Return ["primevideo","amazonprimevideo","amazonprime"];

  Return [];
}

function wa(num,msg){
  return "https://wa.me/"+num+"?text="+encodeURIComponent(msg);
}

async function loadData(){
  const r=await fetch("./data.json",{cache:"no-store"});
  return await r.json();
}

function renderLogo(box, service, category){
  const base=normalize(service);
  const tries=[
    `assets/${base}.png`,
    `assets/${base}.jpg`,
    `https://cdn.simpleicons.org/${base}/ffffff`
  ];
  const img=document.createElement("img");
  let i=0;
  img.onerror=()=>{
    i++;
    if(i<tries.length) img.src=tries[i];
    else box.textContent=EMOJI[category]||"âœ¨";
  };
  img.src=tries[0];
  box.appendChild(img);
}

function renderSections(data){
  if(data.sections?.info_importante?.length){
    infoBox.style.display="block";
    infoList.innerHTML="";
    data.sections.info_importante.forEach(t=>{
      const li=document.createElement("li");
      li.textContent=t;
      infoList.appendChild(li);
    });
  }
  if(data.sections?.distribuidor?.length){
    distBox.style.display="block";
    distList.innerHTML="";
    data.sections.distribuidor.forEach(t=>{
      const li=document.createElement("li");
      li.textContent=t;
      distList.appendChild(li);
    });
  }
}

function render(data){
  businessName.textContent=data.business_name||"CatÃ¡logo";
  const cats=["Todos",...new Set(data.catalog.map(i=>i.category))];
  let active="Todos";

  function drawTabs(){
    tabs.innerHTML="";
    cats.forEach(c=>{
      const b=document.createElement("div");
      b.className="tab"+(c===active?" active":"");
      b.textContent=c;
      b.onclick=()=>{active=c;drawTabs();drawGrid();};
      tabs.appendChild(b);
    });
  }

  function drawGrid(){
    grid.innerHTML="";
    data.catalog
      .filter(i=>active==="Todos"||i.category===active)
      .forEach(item=>{
        const card=document.createElement("div");
        card.className="card";

        const box=document.createElement("div");
        box.className="logo-box";
        renderLogo(box,item.service,item.category);
        card.appendChild(box);

        const n=document.createElement("div");
        n.className="service-name";
        n.textContent=item.service;
        card.appendChild(n);

        item.plans.forEach(p=>{
          const row=document.createElement("div");
          row.className="plan";
          row.innerHTML=`<div>${p.name}</div><div class="price">${data.currency}${p.price}</div>`;
          row.onclick=()=>window.open(
            wa(data.whatsapp_number,
            `Hola, quiero ${item.service} - ${p.name} (${data.currency}${p.price})`)
          );
          card.appendChild(row);
        });

        const w=document.createElement("button");
        w.className="wa";
        w.textContent="Pedir por WhatsApp";
        w.onclick=()=>window.open(
          wa(data.whatsapp_number,`Hola, quiero informaciÃ³n de ${item.service}`)
        );
        card.appendChild(w);

        grid.appendChild(card);
      });
  }

  drawTabs();
  drawGrid();

  floatWA.onclick=()=>window.open(
    wa(data.whatsapp_number,"Hola, quiero hacer un pedido")
  );
}

loadData().then(data=>{
  renderSections(data);
  render(data);
});
</script>
</body>
</html>
