<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>AKAZA SERVICIOS - Cat√°logo</title>

<style>
:root{
  --bg:#0b0b0e;
  --card:#12121a;
  --muted:#b8b8c6;
  --text:#f4f4fb;
  --border:rgba(255,255,255,.10);
  --shadow:0 10px 30px rgba(0,0,0,.35);
  --radius:18px;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:var(--bg);
  color:var(--text);
}
.wrap{max-width:1100px;margin:0 auto;padding:24px 16px 80px}

header{
  padding:20px;
  border:1px solid var(--border);
  border-radius:var(--radius);
  background:var(--card);
  box-shadow:var(--shadow);
  margin-bottom:20px;
}
h1{margin:0;font-size:22px}
.subtitle{color:var(--muted);font-size:13px}

.tabs{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:16px}
.tab{
  padding:8px 14px;
  border-radius:999px;
  border:1px solid var(--border);
  background:#00000055;
  color:var(--muted);
  cursor:pointer;
  font-size:13px;
}
.tab.active{
  background:#20c99733;
  border-color:#20c997;
  color:#fff;
}

.grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:14px;
}
@media(max-width:900px){.grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:600px){.grid{grid-template-columns:1fr}}

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:16px;
  box-shadow:var(--shadow);
}

.logo-box{
  width:120px;
  height:120px;
  margin:0 auto 10px;
  border-radius:22px;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#00000055;
}
.logo-box img{
  width:80%;
  height:80%;
  object-fit:contain;
}

.service-name{
  text-align:center;
  font-weight:800;
  margin-bottom:6px;
}
.hint{
  text-align:center;
  font-size:12px;
  color:var(--muted);
  margin-bottom:10px;
}

.plan{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:10px;
  border:1px solid var(--border);
  border-radius:12px;
  background:#00000044;
  cursor:pointer;
  margin-bottom:6px;
}
.price{font-weight:700}

.wa{
  margin-top:10px;
  width:100%;
  padding:12px;
  border-radius:14px;
  border:1px solid #25D366;
  background:#25D36633;
  color:#fff;
  font-weight:800;
  cursor:pointer;
}

.float-wa{
  position:fixed;
  right:16px;
  bottom:16px;
  width:56px;
  height:56px;
  border-radius:50%;
  background:#25D366;
  color:#08240f;
  font-size:26px;
  display:flex;
  align-items:center;
  justify-content:center;
  border:none;
  cursor:pointer;
  box-shadow:0 18px 35px rgba(0,0,0,.45);
}
</style>
</head>

<body>
<div class="wrap">
  <header>
    <h1 id="businessName">Cat√°logo</h1>
    <div class="subtitle">Plataformas streaming, IA y software</div>
  </header>

  <div class="tabs" id="tabs"></div>
  <div class="grid" id="grid"></div>
</div>

<button class="float-wa" id="floatWA">‚úÜ</button>

<script>
const EMOJI={Streaming:"üé¨",IA:"ü§ñ",Software:"üíª"};

function iconCandidates(service){
  const s=(service||"").toLowerCase();

  if(s.includes("netflix")) return ["netflix"];
  if(s.includes("hbo")) return ["hbomax","hbo"];
  if(s.includes("crunchyroll")) return ["crunchyroll"];
  if(s.includes("paramount")) return ["paramountplus","paramount"];
  if(s.includes("apple tv")) return ["appletv","appletvplus"];
  if(s.includes("spotify")) return ["spotify"];

  // los que fallaban antes
  if(s.includes("disney")) return ["disneyplus","disney"];
  if(s.includes("prime")) return ["primevideo","amazonprimevideo","amazonprime"];

  return [];
}

async function loadData(){
  const r=await fetch("./data.json",{cache:"no-store"});
  return await r.json();
}

function waLink(num,msg){
  return "https://wa.me/"+num+"?text="+encodeURIComponent(msg);
}

function render(data){
  document.getElementById("businessName").textContent=data.business_name;

  const cats=["Todos",...new Set(data.catalog.map(i=>i.category))];
  let active="Todos";

  function drawTabs(){
    const t=document.getElementById("tabs");
    t.innerHTML="";
    cats.forEach(c=>{
      const b=document.createElement("div");
      b.className="tab"+(c===active?" active":"");
      b.textContent=c;
      b.onclick=()=>{active=c;drawTabs();drawGrid();};
      t.appendChild(b);
    });
  }

  function drawGrid(){
    const g=document.getElementById("grid");
    g.innerHTML="";

    data.catalog
      .filter(i=>active==="Todos"||i.category===active)
      .forEach(item=>{
        const card=document.createElement("div");
        card.className="card";

        const box=document.createElement("div");
        box.className="logo-box";

        const candidates=iconCandidates(item.service);
        if(!candidates.length){
          box.textContent=EMOJI[item.category]||"‚ú®";
        }else{
          const img=document.createElement("img");
          let i=0;
          const tryNext=()=>{
            if(i>=candidates.length){
              box.textContent=EMOJI[item.category]||"‚ú®";
              return;
            }
            img.src=`https://cdn.simpleicons.org/${candidates[i]}/ffffff`;
            i++;
          };
          img.onerror=tryNext;
          box.appendChild(img);
          tryNext();
        }

        card.appendChild(box);

        const n=document.createElement("div");
        n.className="service-name";
        n.textContent=item.service;
        card.appendChild(n);

        const h=document.createElement("div");
        h.className="hint";
        h.textContent="Toca un plan para pedir por WhatsApp";
        card.appendChild(h);

        item.plans.forEach(p=>{
          const row=document.createElement("div");
          row.className="plan";
          row.innerHTML=`<div>${p.name}</div><div class="price">${p.price?data.currency+p.price:"Consultar"}</div>`;
          row.onclick=()=>{
            window.open(
              waLink(
                data.whatsapp_number,
                `Hola, quiero pedir: ${item.service} - ${p.name} (${p.price?data.currency+p.price:"Consultar"})`
              )
            );
          };
          card.appendChild(row);
        });

        const wa=document.createElement("button");
        wa.className="wa";
        wa.textContent="Pedir por WhatsApp";
        wa.onclick=()=>window.open(
          waLink(data.whatsapp_number,`Hola, quiero informaci√≥n de ${item.service}`)
        );
        card.appendChild(wa);

        g.appendChild(card);
      });
  }

  drawTabs();
  drawGrid();

  document.getElementById("floatWA").onclick=()=>{
    window.open(waLink(data.whatsapp_number,"Hola, quiero hacer un pedido."));
  };
}

loadData().then(render);
</script>
</body>
</html>

loadData().then(render);
</script>
</body>
</html>
